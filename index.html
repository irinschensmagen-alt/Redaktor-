<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –∏–≥—Ä: Deutsch interaktiv</title>
    <style>
        :root { --primary: #4f46e5; --bg: #f3f4f6; }
        body { font-family: system-ui, -apple-system, sans-serif; background: var(--bg); padding: 20px; color: #333; }
        .container { max-width: 900px; margin: 0 auto; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –õ–æ–≥–æ—Ç–∏–ø–∞ */
        .header-branding { text-align: center; margin-bottom: 20px; }
        .logo-img { 
            width: 150px; 
            height: 150px; 
            border-radius: 50%; 
            object-fit: cover; 
            border: 4px solid var(--primary);
            transition: transform 0.3s ease;
            cursor: pointer;
        }
        .logo-img:hover { transform: scale(1.05); box-shadow: 0 0 15px rgba(79, 70, 229, 0.4); }
        .brand-link { text-decoration: none; display: inline-block; }

        h1 { text-align: center; color: var(--primary); margin-bottom: 10px; }
        .subtitle { text-align: center; color: #666; margin-bottom: 30px; font-style: italic; }

        .section { margin-bottom: 30px; padding: 20px; border: 1px solid #e5e7eb; border-radius: 8px; }
        .section h2 { margin-top: 0; font-size: 1.2rem; color: #1f2937; border-bottom: 2px solid var(--primary); padding-bottom: 10px; display: inline-block; }
        label { display: block; margin-top: 15px; font-weight: 500; font-size: 0.9rem; }
        input[type="text"], select, textarea { width: 100%; padding: 10px; margin-top: 5px; border: 1px solid #d1d5db; border-radius: 6px; box-sizing: border-box; }
        input[type="file"] { margin-top: 5px; }
        .row { display: flex; gap: 20px; flex-wrap: wrap; }
        .col { flex: 1; min-width: 250px; }
        
        /* –¶–≤–µ—Ç–∞ –ª–µ–µ–∫ */
        .category-block { padding: 15px; border-radius: 8px; margin-top: 10px; }
        .cat-red { background: #fee2e2; border: 1px solid #fca5a5; }
        .cat-blue { background: #dbeafe; border: 1px solid #93c5fd; }
        .cat-green { background: #dcfce7; border: 1px solid #86efac; }

        button.generate-btn { background: var(--primary); color: white; border: none; padding: 15px 30px; font-size: 1.1rem; border-radius: 8px; cursor: pointer; width: 100%; transition: 0.2s; font-weight: bold; }
        button.generate-btn:hover { background: #4338ca; }
        
        #outputArea { margin-top: 30px; display: none; }
        textarea#finalCode { font-family: monospace; height: 200px; background: #1f2937; color: #a5f3fc; width: 100%; }
        .note { font-size: 0.8rem; color: #666; margin-top: 2px; }
    </style>
</head>
<body>

<div class="container">
    
    <div class="header-branding">
        <a href="https://t.me/DI_von_Irina" target="_blank" class="brand-link" title="–ü–µ—Ä–µ–π—Ç–∏ –≤ –≥—Ä—É–ø–ø—É Deutsch interaktiv">
            <img src="https://via.placeholder.com/150/4f46e5/ffffff?text=LOGO+DI" alt="Deutsch interaktiv Logo" class="logo-img" id="mainLogo">
        </a>
    </div>

    <h1>–†–µ–¥–∞–∫—Ç–æ—Ä: "–í —Ü–≤–µ—Ç–æ—á–Ω–æ–º –æ–≥–æ—Ä–æ–¥–µ"</h1>
    <p class="subtitle">–°–æ–∑–¥–∞–Ω–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è Deutsch interaktiv</p>

    <div class="section">
        <h2>1. –û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
        <div class="row">
            <div class="col">
                <label>–ù–∞–∑–≤–∞–Ω–∏–µ –∏–≥—Ä—ã</label>
                <input type="text" id="gameTitle" value="–ò–≥—Ä–∞ ¬´–í —Ü–≤–µ—Ç–æ—á–Ω–æ–º –æ–≥–æ—Ä–æ–¥–µ¬ª">
            </div>
            <div class="col">
                <label>–Ø–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞</label>
                <select id="gameLang">
                    <option value="ru">–†—É—Å—Å–∫–∏–π</option>
                    <option value="de" selected>Deutsch</option>
                    <option value="en">English</option>
                </select>
            </div>
        </div>
        <div class="row">
            <div class="col"><label>–ö–Ω–æ–ø–∫–∞ "–°—Ç–∞—Ä—Ç"</label><input type="text" id="textStart" value="Starten"></div>
            <div class="col"><label>–ö–Ω–æ–ø–∫–∞ "–ü–æ–±–µ–¥–∞"</label><input type="text" id="textFinish" value="Gut gemacht!"></div>
            <div class="col"><label>–ö–Ω–æ–ø–∫–∞ "–ü–æ–≤—Ç–æ—Ä–∏—Ç—å"</label><input type="text" id="textRepeat" value="Nochmal"></div>
        </div>
    </div>

    <div class="section">
        <h2>2. –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ</h2>
        <label>–§–æ–Ω (–°–∞–¥)</label>
        <input type="file" id="bgInput" accept="image/*">
        <div class="note">–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∑–∞–≥—Ä—É–∑–∫—É —Å –∫–æ–º–ø—å—é—Ç–µ—Ä–∞ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—à–∏–≤–∞–µ—Ç—Å—è –≤ –∫–æ–¥)</div>

        <div class="row">
            <div class="col"><label>–ü–µ—Ä—Å–æ–Ω–∞–∂ (–•—É–¥–æ–∂–Ω–∏–∫)</label><input type="file" id="heroInput" accept="image/*"></div>
            <div class="col"><label>–ê–Ω—Ç–∞–≥–æ–Ω–∏—Å—Ç (–ü—á–µ–ª–∞)</label><input type="file" id="enemyInput" accept="image/*"></div>
        </div>
        
        <div class="row">
             <div class="col"><label>–ú—É–∑—ã–∫–∞ (MP3)</label><input type="file" id="musicInput" accept="audio/*"></div>
             <div class="col"><label>–ó–≤—É–∫ –Ω–µ—É–¥–∞—á–∏</label><input type="file" id="failSoundInput" accept="audio/*"></div>
        </div>
    </div>

    <div class="section">
        <h2>3. –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ –°–ª–æ–≤–∞ (–õ–µ–π–∫–∏)</h2>
        <div class="category-block cat-red">
            <label>üî¥ –ö—Ä–∞—Å–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è (–Ω–∞–ø—Ä. Die)</label>
            <input type="text" id="cat1Name" value="Die">
            <label>–°–ª–æ–≤–∞ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é):</label>
            <textarea id="cat1Words" rows="2">Katze, Maus, Kuh, Biene, Spinne, Ziege</textarea>
        </div>
        <div class="category-block cat-blue">
            <label>üîµ –°–∏–Ω—è—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è (–Ω–∞–ø—Ä. Der)</label>
            <input type="text" id="cat2Name" value="Der">
            <label>–°–ª–æ–≤–∞ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é):</label>
            <textarea id="cat2Words" rows="2">Hund, Fisch, Hamster, Vogel, L√∂we</textarea>
        </div>
        <div class="category-block cat-green">
            <label>üü¢ –ó–µ–ª–µ–Ω–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è (–Ω–∞–ø—Ä. Das)</label>
            <input type="text" id="cat3Name" value="Das">
            <label>–°–ª–æ–≤–∞ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é):</label>
            <textarea id="cat3Words" rows="2">Pferd, Nashorn, Reh, Schwein, Huhn</textarea>
        </div>
    </div>

    <div class="section">
        <h2>4. –°—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å (–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è)</h2>
        <p class="note">–§–æ—Ä–º–∞—Ç: –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ | –ù–æ–º–µ—Ä –ª–µ–π–∫–∏ (1=–ö—Ä–∞—Å–Ω–∞—è, 2=–°–∏–Ω—è—è, 3=–ó–µ–ª–µ–Ω–∞—è)</p>
        <textarea id="mediumContent" rows="5" placeholder="___ Katze trinkt Milch. | 1">___ Katze trinkt Milch. | 1
___ Hund spielt Ball. | 2
___ Pferd steht auf der Wiese. | 3</textarea>
    </div>

    <button class="generate-btn" onclick="generateGame()">üöÄ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –∏–≥—Ä—ã</button>

    <div id="outputArea" class="section">
        <h2>–ì–æ—Ç–æ–≤—ã–π HTML –∫–æ–¥</h2>
        <p>–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–¥ –Ω–∏–∂–µ –∏ –≤—Å—Ç–∞–≤—å—Ç–µ –≤ Genially (Insert > Others).</p>
        <textarea id="finalCode" readonly></textarea>
        <button onclick="copyCode()" style="margin-top:10px; padding:10px; cursor:pointer; background:#e5e7eb; border:none; border-radius:5px;">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
    </div>
</div>

<script>
    const assets = { bg: '', hero: '', enemy: '', music: '', failSound: '' };

    function handleFile(e, key) {
        const file = e.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = (event) => { assets[key] = event.target.result; };
            reader.readAsDataURL(file);
        }
    }

    document.getElementById('bgInput').addEventListener('change', (e) => handleFile(e, 'bg'));
    document.getElementById('heroInput').addEventListener('change', (e) => handleFile(e, 'hero'));
    document.getElementById('enemyInput').addEventListener('change', (e) => handleFile(e, 'enemy'));
    document.getElementById('musicInput').addEventListener('change', (e) => handleFile(e, 'music'));
    document.getElementById('failSoundInput').addEventListener('change', (e) => handleFile(e, 'failSound'));

    function generateGame() {
        const config = {
            title: document.getElementById('gameTitle').value,
            texts: {
                start: document.getElementById('textStart').value,
                finish: document.getElementById('textFinish').value,
                repeat: document.getElementById('textRepeat').value
            },
            categories: [
                { id: 1, name: document.getElementById('cat1Name').value, words: document.getElementById('cat1Words').value.split(',').map(s=>s.trim()) },
                { id: 2, name: document.getElementById('cat2Name').value, words: document.getElementById('cat2Words').value.split(',').map(s=>s.trim()) },
                { id: 3, name: document.getElementById('cat3Name').value, words: document.getElementById('cat3Words').value.split(',').map(s=>s.trim()) }
            ],
            medium: document.getElementById('mediumContent').value.split('\n').filter(l=>l.includes('|')).map(l => {
                const p = l.split('|'); return { t: p[0].trim(), c: parseInt(p[1].trim()) };
            }),
            assets: {
                bg: assets.bg || 'https://images.unsplash.com/photo-1585320806297-9794b3e4eeae?auto=format&fit=crop&w=1000&q=80',
                hero: assets.hero || 'https://cdn-icons-png.flaticon.com/512/2922/2922510.png',
                enemy: assets.enemy || 'https://cdn-icons-png.flaticon.com/512/3069/3069186.png',
                music: assets.music,
                fail: assets.failSound
            }
        };

        const gameHTML = `
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<style>
  body { margin:0; overflow:hidden; font-family: sans-serif; background: url('${config.assets.bg}') center/cover no-repeat; height: 100vh; width: 100vw; }
  #ui { position: absolute; inset: 0; display: flex; flex-direction: column; align-items: center; justify-content: center; }
  .cans { display: flex; gap: 20px; position: absolute; bottom: 20px; width: 100%; justify-content: center; }
  .can { width: 100px; height: 100px; background: white; border-radius: 10px; display:flex; align-items:center; justify-content:center; font-weight:bold; border: 4px solid #333; cursor: pointer; transition: 0.2s; font-size: 1.2rem; box-shadow: 0 4px 0 rgba(0,0,0,0.2); }
  .can:active { transform: translateY(4px); box-shadow: none; }
  .red { border-color: #ef4444; color: #ef4444; }
  .blue { border-color: #3b82f6; color: #3b82f6; }
  .green { border-color: #22c55e; color: #22c55e; }
  
  #task-box { background: rgba(255,255,255,0.95); padding: 20px 40px; border-radius: 15px; font-size: 2rem; font-weight: bold; margin-bottom: 150px; box-shadow: 0 10px 20px rgba(0,0,0,0.3); border: 2px solid #4f46e5; text-align: center; min-width: 300px; }
  
  #progress { position: absolute; top: 20px; left: 50%; transform: translateX(-50%); display: flex; gap: 5px; }
  .drop { width: 20px; height: 20px; background: rgba(255,255,255,0.5); border-radius: 50% 50% 50% 0; transform: rotate(-45deg); border: 1px solid #3b82f6; }
  .drop.filled { background: #3b82f6; box-shadow: 0 0 10px #3b82f6; }

  #hero { position: absolute; left: 5%; bottom: 140px; height: 200px; transition: 0.3s; }
  #bee { position: absolute; right: -200px; top: 20px; width: 80px; transition: top 1s, right 1s, transform 0.5s; }
  .bee-attack { right: 50% !important; top: 50% !important; transform: scale(2) !important; }

  .screen { position: absolute; inset: 0; background: rgba(255,255,255,0.95); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 100; }
  button.btn { padding: 15px 40px; font-size: 1.5rem; background: #4f46e5; color: white; border: none; border-radius: 50px; cursor: pointer; box-shadow: 0 5px 15px rgba(79, 70, 229, 0.4); transition: 0.3s; }
  button.btn:hover { transform: scale(1.05); }
</style>
</head>
<body>
<div id="start" class="screen">
    <h1 style="color:#4f46e5; font-size: 3rem; margin-bottom: 10px;">${config.title}</h1>
    <button class="btn" onclick="startGame()">${config.texts.start}</button>
</div>
<div id="win" class="screen" style="display:none;">
    <h1 style="color:#22c55e;">${config.texts.finish}</h1>
    <button class="btn" onclick="location.reload()">${config.texts.repeat}</button>
</div>

<div id="ui" style="display:none;">
    <div id="progress"></div>
    <div id="task-box">...</div>
    <img id="hero" src="${config.assets.hero}">
    <img id="bee" src="${config.assets.enemy}">
    
    <div class="cans">
        <div class="can red" onclick="check(1)">${config.categories[0].name}</div>
        <div class="can blue" onclick="check(2)">${config.categories[1].name}</div>
        <div class="can green" onclick="check(3)">${config.categories[2].name}</div>
    </div>
</div>

<script>
    const cfg = ${JSON.stringify(config)};
    let score = 0, max = 10;
    let current = null;
    let mode = 'easy'; // –ú–æ–∂–Ω–æ —Ä–∞—Å—à–∏—Ä–∏—Ç—å –ª–æ–≥–∏–∫—É —É—Ä–æ–≤–Ω–µ–π

    function startGame() {
        document.getElementById('start').style.display = 'none';
        document.getElementById('ui').style.display = 'flex';
        renderDrops();
        nextTask();
        if(cfg.assets.music) { let a = new Audio(cfg.assets.music); a.volume=0.3; a.loop=true; a.play().catch(()=>{}); }
    }
    
    function renderDrops() {
        let h = ''; for(let i=0; i<max; i++) h+='<div class="drop" id="d'+i+'"></div>';
        document.getElementById('progress').innerHTML = h;
    }

    function nextTask() {
        // –ü—Ä–æ—Å—Ç–∞—è –ª–æ–≥–∏–∫–∞: –±–µ—Ä–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ —Å–ª–æ–≤–æ
        let catIdx = Math.floor(Math.random()*3);
        let word = cfg.categories[catIdx].words[Math.floor(Math.random()*cfg.categories[catIdx].words.length)];
        current = { t: word, c: cfg.categories[catIdx].id };
        document.getElementById('task-box').innerText = current.t;
        document.getElementById('bee').classList.remove('bee-attack');
    }

    function check(id) {
        if(id === current.c) {
            document.getElementById('d'+score).classList.add('filled');
            score++;
            if(score >= max) { setTimeout(()=>{document.getElementById('win').style.display='flex'}, 500); }
            else { nextTask(); }
        } else {
            document.getElementById('bee').classList.add('bee-attack');
            if(cfg.assets.fail) new Audio(cfg.assets.fail).play();
        }
    }
<\/script>
</body>
</html>`;
        document.getElementById('outputArea').style.display = 'block';
        document.getElementById('finalCode').value = gameHTML;
    }
    function copyCode() { document.getElementById('finalCode').select(); document.execCommand('copy'); }
</script>
</body>
</html>
