<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Garden Game Editor v4.0</title>
    <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&family=Montserrat:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #8BC34A; --accent: #E91E63; --dark: #2c3e50; }
        body {
            font-family: 'Montserrat', sans-serif;
            background: linear-gradient(180deg, #e6f7ff 0%, #e8f5e9 100%);
            margin: 0; padding: 20px;
            overflow-y: auto; /* –í–∫–ª—é—á–∞–µ—Ç —Å–∫—Ä–æ–ª–ª */
            height: 100vh;
        }
        .container {
            max-width: 950px; margin: 0 auto; background: white;
            border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.15);
            padding: 30px; border: 4px solid #fff;
        }
        
        /* Header */
        .header { display: flex; gap: 20px; align-items: center; border-bottom: 2px dashed #ccc; padding-bottom: 20px; margin-bottom: 20px; }
        .logo-box { width: 70px; height: 70px; border-radius: 50%; overflow: hidden; border: 3px solid var(--accent); cursor: pointer; }
        .logo-box img { width: 100%; height: 100%; object-fit: cover; }
        h1 { margin: 0; color: var(--dark); font-size: 1.5rem; }
        .badge { background: var(--accent); color: white; padding: 2px 8px; border-radius: 10px; font-size: 0.7rem; vertical-align: middle; }

        /* Grid System */
        .grid { display: grid; gap: 20px; }
        .g2 { grid-template-columns: 1fr 1fr; }
        .g3 { grid-template-columns: 1fr 1fr 1fr; }

        /* Inputs */
        .section-title { font-weight: 800; color: var(--primary); text-transform: uppercase; font-size: 0.9rem; margin-top: 10px; border-bottom: 2px solid #eee; padding-bottom: 5px; }
        label { display: block; font-size: 0.75rem; font-weight: 700; color: #777; margin-top: 10px; margin-bottom: 4px; text-transform: uppercase; }
        input, select, textarea { width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-family: inherit; font-size: 0.9rem; box-sizing: border-box; }
        input:focus { border-color: var(--primary); outline: none; }

        /* Asset Uploaders */
        .upload-btn {
            background: #f0f4c3; color: #558b2f; padding: 8px; border-radius: 8px; 
            text-align: center; cursor: pointer; border: 2px dashed #cddc39; font-size: 0.8rem; font-weight: bold;
            display: flex; align-items: center; justify-content: center; gap: 5px;
        }
        .upload-btn:hover { background: #e6ee9c; }
        .status-ok { color: green; font-size: 10px; display: none; }

        /* Categories */
        .cat-card { padding: 15px; border-radius: 12px; border: 2px solid transparent; }
        .c-red { background: #ffebee; border-color: #ffcdd2; }
        .c-blue { background: #e3f2fd; border-color: #bbdefb; }
        .c-green { background: #e8f5e9; border-color: #c8e6c9; }

        /* Buttons */
        .btn-big {
            width: 100%; padding: 18px; border: none; border-radius: 12px;
            font-size: 1.1rem; font-weight: 800; text-transform: uppercase; cursor: pointer;
            transition: 0.2s; margin-top: 20px; color: white;
            box-shadow: 0 5px 0 rgba(0,0,0,0.1);
        }
        .btn-gen { background: linear-gradient(45deg, #43A047, #8BC34A); }
        .btn-gen:hover { transform: translateY(-2px); box-shadow: 0 7px 0 rgba(0,0,0,0.1); }
        .btn-gen:active { transform: translateY(2px); box-shadow: none; }

        .btn-copy { background: #2c3e50; margin-top: 10px; }
        
        #codeOutput { width: 100%; height: 120px; margin-top: 10px; background: #222; color: #0f0; font-family: monospace; border-radius: 8px; padding: 10px; }

    </style>
</head>
<body>

<div class="container">
    
    <div class="header">
        <a href="https://t.me/DI_von_Irina" target="_blank" title="–ì—Ä—É–ø–ø–∞ Deutsch interaktiv">
            <div class="logo-box">
                <img src="https://via.placeholder.com/100/E91E63/FFFFFF?text=DI" alt="Logo"> 
            </div>
        </a>
        <div>
            <h1>–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä: "–í —Ü–≤–µ—Ç–æ—á–Ω–æ–º –æ–≥–æ—Ä–æ–¥–µ" <span class="badge">v4.0 PRO</span></h1>
            <div style="font-size: 0.8rem; color: #666;">Deutsch interaktiv | –°—é–∂–µ—Ç: –†–∞—Å–∫—Ä–∞—Å–∫–∞ –±–∞–±–æ—á–∫–∏ + –†–æ–∑–∞ + –ü—á–µ–ª–∞</div>
        </div>
    </div>

    <div class="grid g2">
        <div>
            <div class="section-title">1. –ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
            <label>–ù–∞–∑–≤–∞–Ω–∏–µ –∏–≥—Ä—ã</label>
            <input type="text" id="gTitle" value="–í–æ–ª—à–µ–±–Ω—ã–π –°–∞–¥">
            
            <label>–Ø–∑—ã–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞</label>
            <select id="gLang">
                <option value="ru">–†—É—Å—Å–∫–∏–π</option>
                <option value="de" selected>Deutsch</option>
                <option value="en">English</option>
                <option value="fr">Fran√ßais</option>
                <option value="es">Espa√±ol</option>
                <option value="it">Italiano</option>
                <option value="cn">‰∏≠Êñá</option>
                <option value="jp">Êó•Êú¨Ë™û</option>
            </select>
            
            <div class="grid g2">
                <div><label>–ö–Ω–æ–ø–∫–∞ –°—Ç–∞—Ä—Ç</label><input type="text" id="txtStart" value="Starten"></div>
                <div><label>–ö–Ω–æ–ø–∫–∞ –ï—â—ë —Ä–∞–∑</label><input type="text" id="txtRep" value="Nochmal"></div>
            </div>
        </div>

        <div>
            <div class="section-title">2. –ü–µ—Ä—Å–æ–Ω–∞–∂–∏ –∏ –ó–≤—É–∫–∏</div>
            <p style="font-size:11px; color:#666; margin:0 0 10px 0;">–í —Ä–µ–¥–∞–∫—Ç–æ—Ä —É–∂–µ –≤—Å—Ç—Ä–æ–µ–Ω—ã –º—É–ª—å—Ç—è—à–Ω—ã–µ –∫–∞—Ä—Ç–∏–Ω–∫–∏! –ú–µ–Ω—è–π—Ç–µ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∂–µ–ª–∞–Ω–∏–∏.</p>
            
            <div class="grid g2">
                <div>
                    <label class="upload-btn">üé® –•—É–¥–æ–∂–Ω–∏–∫ <input type="file" hidden onchange="load(this, 'hero')"></label>
                    <span id="st-hero" class="status-ok">–ó–∞–≥—Ä—É–∂–µ–Ω —Å–≤–æ–π</span>
                </div>
                <div>
                    <label class="upload-btn">üêù –ó–ª–∞—è –ü—á–µ–ª–∞ <input type="file" hidden onchange="load(this, 'bee')"></label>
                    <span id="st-bee" class="status-ok">–ó–∞–≥—Ä—É–∂–µ–Ω —Å–≤–æ–π</span>
                </div>
                <div>
                    <label class="upload-btn">üåÑ –§–æ–Ω <input type="file" hidden onchange="load(this, 'bg')"></label>
                    <span id="st-bg" class="status-ok">–ó–∞–≥—Ä—É–∂–µ–Ω —Å–≤–æ–π</span>
                </div>
                <div>
                    <label class="upload-btn">üéµ –ú—É–∑—ã–∫–∞ <input type="file" hidden onchange="load(this, 'music')"></label>
                    <span id="st-music" class="status-ok">–ó–∞–≥—Ä—É–∂–µ–Ω —Å–≤–æ–π</span>
                </div>
            </div>
        </div>
    </div>

    <div class="section-title">3. –°–ª–æ–≤–∞ –∏ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ (–†–∞—Å–∫—Ä–∞—Å–∫–∞)</div>
    <div class="grid g3">
        <div class="cat-card c-red">
            <label style="color:#D32F2F">üü• –ö—Ä–∞—Å–Ω–∞—è (Die / <10)</label>
            <input type="text" id="c1n" value="Die">
            <label>–°–ª–æ–≤–∞ (10-15 —à—Ç):</label>
            <textarea id="c1w" rows="4">Katze, Maus, Kuh, Biene, Spinne, Ziege, Ente, Tante, Lampe, Tasche</textarea>
        </div>
        <div class="cat-card c-blue">
            <label style="color:#1976D2">üü¶ –°–∏–Ω—è—è (Der / >10)</label>
            <input type="text" id="c2n" value="Der">
            <label>–°–ª–æ–≤–∞ (10-15 —à—Ç):</label>
            <textarea id="c2w" rows="4">Hund, Fisch, Hamster, Vogel, L√∂we, Elefant, Tisch, Stuhl, Vater, Onkel</textarea>
        </div>
        <div class="cat-card c-green">
            <label style="color:#388E3C">üü© –ó–µ–ª–µ–Ω–∞—è (Das / =10)</label>
            <input type="text" id="c3n" value="Das">
            <label>–°–ª–æ–≤–∞ (10-15 —à—Ç):</label>
            <textarea id="c3w" rows="4">Pferd, Schwein, Huhn, Schaf, Krokodil, Buch, Haus, Fenster, Kind, Auto</textarea>
        </div>
    </div>

    <button class="btn-big btn-gen" onclick="makeGame()">‚ú® –°–æ–∑–¥–∞—Ç—å –ò–≥—Ä—É (–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ö–æ–¥)</button>

    <div id="resultBlock" style="display:none; margin-top:20px;">
        <div class="section-title">–ì–æ—Ç–æ–≤—ã–π –∫–æ–¥ –¥–ª—è Genially (Insert > Others)</div>
        <textarea id="codeOutput" readonly></textarea>
        <button class="btn-big btn-copy" onclick="copyIt()">üìã –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥ –≤ –±—É—Ñ–µ—Ä</button>
    </div>

</div>

<script>
    // –í–°–¢–†–û–ï–ù–ù–´–ï –†–ï–°–£–†–°–´ (–ß–¢–û–ë–´ –†–ê–ë–û–¢–ê–õ–û –°–†–ê–ó–£)
    const defaults = {
        // –ú—É–ª—å—Ç—è—à–Ω—ã–π —Ñ–æ–Ω (–ª—É–≥)
        bg: 'https://img.freepik.com/free-vector/scene-with-green-lawn-garden_1308-49033.jpg?w=1380',
        // –í–µ—Å–µ–ª—ã–π —Ö—É–¥–æ–∂–Ω–∏–∫
        hero: 'https://cdn-icons-png.flaticon.com/512/3069/3069172.png',
        // –ó–ª–∞—è –ø—á–µ–ª–∞
        bee: 'https://cdn-icons-png.flaticon.com/512/826/826955.png',
        // –ó–≤—É–∫–∏ (–∫–æ—Ä–æ—Ç–∫–∏–µ MP3 –≤ base64 –∏–ª–∏ —Å—Å—ã–ª–∫–∏)
        sndWin: 'https://actions.google.com/sounds/v1/cartoon/cartoon_boing.ogg',
        sndFail: 'https://actions.google.com/sounds/v1/animals/buzzing_fly.ogg', // –ñ—É–∂–∂–∞–Ω–∏–µ
        sndPour: 'https://actions.google.com/sounds/v1/water/water_droplet.ogg', // –ö–∞–ø–ª—è
        music: '' // –ú—É–∑—ã–∫—É –ª—É—á—à–µ –Ω–µ –≤–∫–ª—é—á–∞—Ç—å –ø–æ –¥–µ—Ñ–æ–ª—Ç—É, —á—Ç–æ–±—ã –Ω–µ –º–µ—à–∞–ª–∞
    };

    let userAssets = { ...defaults };

    function load(input, key) {
        if(input.files && input.files[0]) {
            const reader = new FileReader();
            reader.onload = function(e) {
                userAssets[key] = e.target.result;
                document.getElementById('st-'+key).style.display = 'inline';
            }
            reader.readAsDataURL(input.files[0]);
        }
    }

    function makeGame() {
        const title = document.getElementById('gTitle').value;
        const btnStart = document.getElementById('txtStart').value;
        const btnRep = document.getElementById('txtRep').value;
        
        // –°–æ–±–∏—Ä–∞–µ–º —Å–ª–æ–≤–∞
        const c1 = { name: document.getElementById('c1n').value, words: document.getElementById('c1w').value.split(',').map(s=>s.trim()) };
        const c2 = { name: document.getElementById('c2n').value, words: document.getElementById('c2w').value.split(',').map(s=>s.trim()) };
        const c3 = { name: document.getElementById('c3n').value, words: document.getElementById('c3w').value.split(',').map(s=>s.trim()) };
        
        // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º HTML –∏–≥—Ä—ã (ENGINE)
        // –í–ù–ò–ú–ê–ù–ò–ï: –≠—Ç–æ —Å–ª–æ–∂–Ω—ã–π –∫–æ–¥ —Å SVG –∏ –ª–æ–≥–∏–∫–æ–π
        const html = `
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<style>
  @import url('https://fonts.googleapis.com/css2?family=Comic+Neue:wght@700&display=swap');
  body { margin:0; overflow:hidden; font-family: 'Comic Neue', cursive; 
         background: url('${userAssets.bg}') center/cover no-repeat; user-select: none; }
  
  /* UI LAYOUT */
  #game { position: absolute; inset: 0; display: none; flex-direction: column; align-items: center; }
  
  /* TOP BAR */
  .top-bar { margin-top: 10px; background: rgba(255,255,255,0.8); padding: 5px 20px; border-radius: 20px; font-size: 24px; font-weight: bold; color: #444; border: 2px solid #fff; }

  /* SCENE */
  .scene { position: relative; flex: 1; width: 100%; max-width: 800px; display: flex; justify-content: center; align-items: flex-end; padding-bottom: 20px; }
  
  /* HERO & BEE */
  #hero { position: absolute; left: 20px; bottom: 140px; height: 180px; z-index: 5; transition: transform 0.2s; }
  #bee { position: absolute; right: -150px; top: 50px; width: 80px; z-index: 20; transition: all 1s ease-in-out; }
  .bee-attack { right: 50% !important; top: 60% !important; transform: scale(2.5) rotate(-20deg) !important; }

  /* ROSE & BUTTERFLY SVG CONTAINER */
  #garden-svg { width: 400px; height: 500px; filter: drop-shadow(0 5px 10px rgba(0,0,0,0.2)); z-index: 10; overflow: visible; }
  
  /* SVG STYLES */
  .rose-part { fill: #ddd; stroke: #555; stroke-width: 2px; transition: fill 1s; }
  .butterfly-part { fill: #fff; stroke: #333; stroke-width: 2px; transition: fill 0.5s; }
  .butterfly-group { transition: transform 0.5s; cursor: default; }
  
  /* ANIMATIONS */
  .fly-away { animation: flying 2s infinite ease-in-out, moveUp 3s forwards linear; }
  @keyframes flying { 0%{transform: scale(1) rotate(0deg);} 50%{transform: scale(0.9, 1.1) rotate(5deg);} 100%{transform: scale(1) rotate(0deg);} }
  @keyframes moveUp { to { transform: translateY(-400px) translateX(100px); opacity: 0; } }
  
  .glow { animation: glowing 2s infinite alternate; }
  @keyframes glowing { from {filter: drop-shadow(0 0 5px white);} to {filter: drop-shadow(0 0 20px gold);} }

  /* CANS (CONTROLS) */
  .cans { display: flex; gap: 20px; margin-bottom: 20px; z-index: 50; }
  .can { 
    width: 90px; height: 100px; background: white; border-radius: 15px; 
    border: 4px solid #ccc; display: flex; flex-direction: column; 
    align-items: center; justify-content: center; cursor: pointer;
    font-size: 1.2rem; transition: transform 0.2s; position: relative;
    box-shadow: 0 5px 0 rgba(0,0,0,0.2);
  }
  .can:active { transform: translateY(4px); box-shadow: none; }
  .can.pouring { transform: rotate(-45deg) translateY(-20px); }
  
  .c-red { border-color: #E53935; color: #E53935; }
  .c-blue { border-color: #1E88E5; color: #1E88E5; }
  .c-green { border-color: #43A047; color: #43A047; }
  
  /* WATER DROP */
  .drop { position: absolute; width: 15px; height: 15px; background: #29B6F6; border-radius: 50% 0 50% 50%; transform: rotate(-45deg); opacity: 0; pointer-events: none; }
  .drop-anim { animation: drip 0.6s linear; }
  @keyframes drip { 0% { opacity: 1; top: -20px; } 100% { opacity: 0; top: 100px; } }

  /* CURRENT WORD */
  #word-bubble {
      position: absolute; top: 20px; left: 50%; transform: translateX(-50%);
      background: white; padding: 15px 30px; border-radius: 50px;
      font-size: 2rem; font-weight: bold; color: #333;
      box-shadow: 0 5px 15px rgba(0,0,0,0.2); border: 3px solid #FF9800;
      animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  }
  @keyframes popIn { from{transform: translateX(-50%) scale(0);} to{transform: translateX(-50%) scale(1);} }

  /* SCREENS */
  .overlay { position: absolute; inset: 0; background: rgba(255,255,255,0.95); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 100; text-align: center; }
  .btn-start { padding: 15px 40px; font-size: 24px; background: #8BC34A; color: white; border: none; border-radius: 50px; cursor: pointer; box-shadow: 0 5px 0 #558B2F; font-family: inherit; }
  .btn-start:hover { transform: scale(1.05); }

</style>
</head>
<body>

<div id="scr-start" class="overlay">
    <h1 style="color:#2c3e50; font-size:3rem; margin-bottom:10px;">${title}</h1>
    <div style="font-size:1.2rem; color:#666; margin-bottom:30px;">–†–∞—Å–∫—Ä–∞—Å—å –±–∞–±–æ—á–∫—É –∏ –æ–∂–∏–≤–∏ —Ä–æ–∑—É!</div>
    <button class="btn-start" onclick="init()">${btnStart}</button>
</div>

<div id="scr-win" class="overlay" style="display:none;">
    <h1 style="color:#E91E63; font-size:3rem;">Bravo!</h1>
    <button class="btn-start" onclick="location.reload()">${btnRep}</button>
</div>

<div id="game">
    <div id="word-bubble">...</div>
    
    <div class="scene">
        <img id="hero" src="${userAssets.hero}">
        <img id="bee" src="${userAssets.bee}">
        
        <svg id="garden-svg" viewBox="0 0 200 300">
            <g id="rose-stem">
                <path class="rose-part" d="M100,280 Q100,200 100,150" fill="none" stroke-width="4"/>
                <path class="rose-part" id="leaf1" d="M100,200 Q80,180 60,200 Q80,220 100,200" fill="#ddd"/>
                <path class="rose-part" id="leaf2" d="M100,180 Q120,160 140,180 Q120,200 100,180" fill="#ddd"/>
            </g>
            
            <g id="rose-flower" transform="translate(100,130)">
                 <circle class="rose-part" id="p1" cx="-10" cy="0" r="15" />
                 <circle class="rose-part" id="p2" cx="10" cy="0" r="15" />
                 <circle class="rose-part" id="p3" cx="0" cy="-15" r="15" />
                 <circle class="rose-part" id="p4" cx="0" cy="5" r="12" />
            </g>
            
            <g id="butterfly" class="butterfly-group" transform="translate(100, 110)">
                <path class="butterfly-part" id="b1" d="M-5,0 Q-30,-30 -50,-10 T-5,10" />
                <path class="butterfly-part" id="b2" d="M-5,10 Q-30,40 -40,20 T-5,15" />
                <path class="butterfly-part" id="b3" d="M5,0 Q30,-30 50,-10 T5
